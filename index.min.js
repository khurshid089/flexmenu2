this.find('li').length,firstItemTop=Math.floor($firstItem.offset().top),firstItemHeight=Math.floor($firstItem.outerHeight(!0)),$btn;function needsMenu($itemOfInterest){return(Math.ceil($itemOfInterest.offset().top)>=(firstItemTop+firstItemHeight))?!0:!1}
if(needsMenu($lastItem)&&numItems>s.threshold&&!s.undo&&(s.shouldApply())){$this.append('<span class="more-btn" title="'+s.linkTitle+'">'+s.linkText+'</span>');$this.addClass('overflow');$btn=$this.find('span.more-btn');$btn.click(function(e){e.preventDefault();$this.toggleClass('open')})}else if(s.undo){$this.find('span.more-btn').remove();$this.removeClass('overflow')}})}}))